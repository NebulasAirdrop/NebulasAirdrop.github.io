<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../img/nas.ico">

    <title>Airdrops</title>

    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.css" rel="stylesheet">
    <link href="../css/icons/icomoon/styles.css" rel="stylesheet" type="text/css">
    <link href="../css/core.css" rel="stylesheet" type="text/css">
    <link href="../css/components.css" rel="stylesheet" type="text/css">
    <link href="../css/colors.css" rel="stylesheet" type="text/css">
    <link href="../css/summernote.css" rel="stylesheet" type="text/css">
    <link href="../css/owl.carousel.min.css" rel="stylesheet" type="text/css">
    <link href="../css/owl.theme.default.min.css" rel="stylesheet" type="text/css">

    <!-- Custom styles for this template -->
    <link href="../airdrop.css" rel="stylesheet">

    <!-- Import Javascript -->
    <script src="../js/jquery-3.3.1.min.js"></script>
    <script src="../js/nebPay.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/nebulas.js"></script>
    <script src="../js/airdropConfig.js"></script>
    <script src="../js/nebConfig.js"></script>
    <script src="../js/mustache.min.js"></script>

  </head>

      <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom box-shadow">
        <img src="../img/naslogo.png" height="50" width="50">
        <h4 class="my-0 mr-md-auto font-weight-normal" style="padding-left: 0px; padding-right: 0px">&nbsp;Nebulas</h4>
        <h4 class="my-0 mr-md-auto font-weight-normal" style="padding-left: 5px; padding-right: 10px">&nbsp;Airdrop</h4>
        <input type="text" id="address" class="form-control" placeholder="n1UUr6ipRiboc..." value="" name="address" style="margin-left: 10px">
        <button type="button" class="btn btn-primary" onclick="search()" style="margin: 10px">Search</button>
        <nav class="my-2 my-md-0 mr-md-3">
        <a class="btn btn-outline-primary" href="new.html#">New Airdrop</a>
        </nav>
        <nav class="my-2 my-md-0 mr-md-3">
          <a class="btn btn-outline-primary" href="promotion.html" target="_blank">Airdrop Plan</a>
        </nav>
        <nav class="my-2 my-md-0 mr-md-3">
          <a class="btn btn-outline-primary" href="../index.html">中文</a>
        </nav>
      </div>

      <section class="promotion-airdrop-section">
        <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
          <h1 class="display-5">Nebulas Airdrop Promotion Plan</h1>
          <p class="lead"> In line with the incentive cycle of the Nebulas Incentive Program, we will set an airdrop on the site in the following week. The funds come from the bonuses that the Nebulas dropped during the week in the Nebulas Incentive Program.
          </p>
        </div>


        <div class="container" >
          <div class="card-deck mb-2 text-center" id="promotions">
          </div>
        </div>
      </section>

      <section class="referrer-section" id="referrer">
        <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
          <h2 class="display-5">Why You Need a Invitation Link?</h2>
          <p class="lead">You can get extra tokens each time your friends get airdrops through your invitation link. And your friends will also get extra tokens from your invitation link.</p>
        </div>

        <div class="container">
          <div class="card-deck mb-3 text-center">
            <div class="card mb-4 box-shadow">
              <div class="card-body">
                <input type="text" id="referrer_address" class="form-control" placeholder="n1UUr6ipRiboc..." value="" name="referrer_address">
                <button type="button" class="btn btn-primary" onclick="generateLink()" style="margin: 10px">Generate</button>
              </div>
            </div>
          </div>
        </div>
        <div id="referrer_link">
        </div>
      </section>

      <section class="airdrop-section">
        <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
          <h2 class="display-5">Other Airdrop Projects</h2>
          <p class="lead">Please note that listing on nasdrop.info is free. Because we have a Smart Contract on Nebulas Mainnet and run the website as a Dapp, it just take several seconds for your Airdrop to be published. Please be careful not to generate junk airdrops, otherwise your nebulas address will be blacklisted.</p>
        </div>
        <div class="container" >
          <div class="card-deck mb-2 text-center" id="airdrops">
          </div>
        </div>

        <div class="container" >
          <div class="card-deck mb-2 text-center" id="testAirdrops">
          </div>
        </div>
      </section>

      <section class="info-section" id="info">
        <div class="container">
          <div class="row">
            <h2 class="display-5">FAQ</h2>
            <div class="col-lg-12">
              <div class="panel info-panel"><div class="panel-heading">
                <h3>What is a crypto airdrop?</h3>
              </div><div class="panel-content" style="overflow: hidden; height: 0px;">
                <div class="info-content">
                  <p style="word-break: break-word; color: rgb(51, 51, 51);">A<b>​ ​crypto airdrop</b>​ ​is​ ​when​ ​a​ ​blockchain project distribute​s free​ ​tokens or​ ​coins to​ ​the​ crypto ​community.</p><p style="word-break: break-word; color: rgb(51, 51, 51);">To​ ​be​ ​a​ ​recipient​ ​of​ ​an​ crypto ​airdrop often​ ​the​ ​only​ ​requirement​ ​is​ ​that​ ​you​ ​have​ ​coins from the relevant blockchain stored​ ​in​ ​your​ ​wallet. On Nebulas Airdrop everyone can get some free tokens if he has some NAS.</p>
                </div>
              </div>
              </div>
            </div>
            <div class="col-lg-12">
              <div class="panel info-panel"><div class="panel-heading">
                <h3>Where can I get NAS?</h3>
              </div><div class="panel-content" style="overflow: hidden; height: 0px;">
                <div class="info-content">
                  <p style="word-break: break-word; color: rgb(51, 51, 51);">You can buy NAS from crypto exchanges, such as <a href="https://huobi.pro" target="_blank">Huobi</a>, <a href="https://www.okex.com" target="_blank">OKEX</a> and <a href="https://gate.io/" target="_blank">gate.io</a> . Then you can withdraw NAS to your accounts. There are some NAS faucets where you can get minor NAS.<br><ol><li style="word-break: break-word; color: rgb(51, 51, 51);"><a href="https://nas.biyouduo.com">https://nas.biyouduo.com</a></li><li style="word-break: break-word; color: rgb(51, 51, 51);"><a href="https://nebulagram.com/">https://nebulagram.com</a></li><li style="word-break: break-word; color: rgb(51, 51, 51);"><a href="http://givemenas.com/home.html">http://givemenas.com</a> </li></ol><p style="word-break: break-word; color: rgb(51, 51, 51);">Check your account constantly to see if you received surprise airdrops!</p>
                </div>
              </div>
              </div>
            </div>
            <div class="col-lg-12">
              <div class="panel info-panel"><div class="panel-heading">
                <h3>Why do ICO's give away free tokens?</h3>
              </div><div class="panel-content" style="overflow: hidden; height: 0px;">
                <div class="info-content">
                  <p style="word-break: break-word; color: rgb(51, 51, 51);">If&nbsp;you're not paying for the&nbsp;product,&nbsp;you are the product. With doing an airdrop the project creates awareness about their ICO or token. It brings people to the project that otherwise would not have owned or heard about it. It could lead to token price appreciation, since people value a token they own higher than a token they don't own. This is called the endowment effect.</p><p style="word-break: break-word; color: rgb(51, 51, 51);">Airdrops create a community/network of people who own the tokens. If you would list the token distribution after an ICO in a pie graph, a large part of the pie is still owned by the Dev's or project. Another large part is owned by people who joined a pre-sale. And a reasonable part is owned by people who invested in the ICO. An airdrop adds an extra slice to the pie and that slice will have the most people in it.</p><p style="word-break: break-word; color: rgb(51, 51, 51);">An airdrop also plants a seed. When you look at Coinmarketcap you will see a list of thousand coins. Just on page one you can see 100 coins listed. However if you have or had a coin that name is still in your brain. The seed is planted and whenever you check Coinmarketcap and scroll down, the name of the free e-Coin will jump out and people will check how it is doing. If they see an article that the free e-Token is doing well or bad, they are more likely to click it if they own it or previously have owned it. It's just like advertising!</p><p style="word-break: break-word; color: rgb(51, 51, 51);">Looking​ ​forward,​ ​possible​ crypto ​airdrop​ ​developments​ ​could​ ​be​ ​projects​ ​starting​ ​to​ ​gift​ ​tokens​ ​to​ ​users​ ​who hold​ ​tokens​ ​in​ ​projects​ ​that​ ​overlap​ ​or​ ​have​ ​some​ ​synergy​ ​with​ ​their​ ​own.​ ​We​ ​could​ ​also​ ​see​ ​projects encouraging​ ​other​ ​projects​ ​to​ ​airdrop​ ​to​ ​their​ ​token​ ​owners​ ​and​ ​receiving​ ​some​ ​benefit​ ​in​ ​return. Like we already see happening at the Nebulas, Ethereum, Waves, NXT &amp; Komodo platforms.</p>
                </div>
              </div>
              </div>
            </div>
            <div class="col-lg-12">
              <div class="panel info-panel"><div class="panel-heading">
                <h3>Where do I sell my airdrops?</h3>
              </div><div class="panel-content" style="overflow: hidden; height: 0px;">
                <div class="info-content">
                  <p style="word-break: break-word; color: rgb(51, 51, 51);">So now you have free crypto, what do you do? Many coins that do airdrops are PRE-ICO or just finished their ICO. This often means it is not traded yet on the bigger exchanges. You can check out our exchange page to see where you can best <a href="https://coinmarketcap.com" target="_blank">sell your crypto airdrops</a>.</p><p style="word-break: break-word; color: rgb(51, 51, 51);">We suggest you make an account at all exchanges we listed so you can easily sell and receive your crypto airdrops.</p><p style="word-break: break-word; color: rgb(51, 51, 51);">We hope you receive as many airdrops as possible and that they increase in value over time. Many projects that are now top 40 coins have done airdrops in their early stages, like NAS, DECRED &amp; Ripple. You don't need to immediately sell your free crypto, there is nothing wrong with being a HODLer.</p>
                </div>
              </div>
              </div>
            </div>
            <div class="col-lg-12">
              <div class="panel info-panel"><div class="panel-heading">
                <h3>How do I keep my cryptocurrency safe?</h3>
              </div><div class="panel-content" style="overflow: hidden; height: 0px;">
                <div class="info-content">
                  <p style="word-break: break-word; color: rgb(51, 51, 51);">The safest way to store your airdrops are hardware &amp; cold storage wallets. These wallets store your coins offline, and therefore protect them from being hacked. There are a number of hardware wallets available. We would advise to use the&nbsp;<a href="https://www.ledgerwallet.com/r/5530" target="_blank" rel="noopener noreferrer">Ledger Wallet Nano S</a>&nbsp;or&nbsp;<a href="https://trezor.io/?a=airdropalert.com" target="_blank" rel="noopener noreferrer">Trezor</a>.</p><p style="word-break: break-word; color: rgb(51, 51, 51);">Not all cryptocurrency can be stored in hardware wallets. We advise you to store your crypto in wallets where you control your private keys. You don't want your free crypto to be stolen!</p><p style="word-break: break-word; color: rgb(51, 51, 51);">To avoid scams we have a few general rules:</p><ol><li style="word-break: break-word; color: rgb(51, 51, 51);"><span style="color: rgb(0, 0, 0);">Never give your private keys!</span></li><li style="word-break: break-word; color: rgb(51, 51, 51);">Use 2 Factor Authentication on your wallets</li><li style="word-break: break-word; color: rgb(51, 51, 51);">Be careful downloading wallets of smaller project, possibly use a Virtual machine.</li><li style="word-break: break-word; color: rgb(51, 51, 51);">Never click on links redirecting to wallets</li><li style="word-break: break-word; color: rgb(51, 51, 51);">Don’t use your main email address to apply for airdrops</li><li style="word-break: break-word; color: rgb(51, 51, 51);">Don’t re-use your passwords when you register on a website</li><li style="word-break: break-word; color: rgb(51, 51, 51);">Don’t send your crypto to airdrop project directly<br></li></ol>
                </div>
              </div>
              </div>
            </div>
            <div class="col-lg-12">
              <div class="panel info-panel"><div class="panel-heading">
                <h3>Earn a bounty by alerting us of scams</h3>
              </div><div class="panel-content" style="overflow: hidden; height: 0px;">
                <div class="info-content">
                  <p><span style="color: rgb(51, 51, 51);">We strive to keep our website free of scam projects. However it is still possible we miss a scam project. We award people with $5 worth in NAS if you email us about a scam on our website inactive or active airdrops. Help us to keep the site clean and prevent other people to be a victim of a scam.&nbsp;</span><span style="color: rgb(51, 51, 51);">Contact us at:&nbsp;</span><a href="mailto:support@mail.nasdrop.info" style="background-color: rgb(255, 255, 255);">support@mail.nasdrop.info</a><br></p>
                </div>
              </div>
              </div>
            </div>
            <div class="col-lg-12">
              <div class="panel info-panel"><div class="panel-heading">
                <h3>List your airdrop!</h3>
              </div><div class="panel-content" style="overflow: hidden; height: 0px;">
                <div class="info-content">
                  <p>Do you want to list your airdrop on <a href="http://nasdrop.info" target="_blank">nasdrop.info</a>?</p><p><span style="color: rgb(51, 51, 51);">Please note that listing on nasdrop.info is free. Because we have a Smart Contract on Nebulas Mainnet and run the website as a Dapp, it just take several seconds for your Airdrop to be published. Please be careful not to generate junk airdrops, otherwise your nebulas address will be blacklisted.<br></span><br>Go ahead and <a href="new.html" target="_blank">create your airdrop</a>!</p>
                </div>
              </div>
              </div>
            </div>
          </div>
        </div>

        <script type="text/javascript">
          function toggleVisibility(event) {
            event.preventDefault();

            var findAncestor = function (el, cls) {
              while ((el = el.parentElement) && !el.classList.contains(cls));
              return el;
            }

            var infoPanel = findAncestor(event.target, 'info-panel');

            var panelContent = infoPanel.childNodes[1];

            if (panelContent.style.overflow === "hidden") {
              panelContent.style.overflow = '';
              panelContent.style.height = '';
            } else {
              panelContent.style.overflow = 'hidden';
              panelContent.style.height = '0px';
            }
          }

          var elements = document.getElementsByClassName('panel-heading');
          for (var index in elements) {
            var element = document.getElementsByClassName('panel-heading')[index];

            if (element.addEventListener) {
              element.addEventListener('click', toggleVisibility);
            }
          }
        </script>
      </section>

    <section>
      <footer class="pt-4 my-md-5 pt-md-5 border-top">
        <div class="row">
          <div class="col-12 col-md">
            <img class="mb-2" src="../img/naslogo1.png" alt="" width="24" height="24">
            <small class="d-block mb-3 text-muted">&copy; 2018</small>
          </div>
          <div class="col-6 col-md">
            <h5>Resources</h5>
            <ul class="list-unstyled text-small">
              <li><a class="text-muted" href="https://nebulas.io">Official Website</a></li>
              <li><a class="text-muted" href="https://explorer.nebulas.io">Nebulas Explorer</a></li>
              <li><a class="text-muted" href="https://github.com/ChengOrangeJu/WebExtensionWallet">Nebulas Wallet</a></li>
              <li><a class="text-muted" href="https://github.com/ethgamble/ethgamble.github.io">GitHub Source</a></li>
              <li><a class="text-muted" href="" id="contract">Contract Address</a></li>
            </ul>
          </div>
          <div class="col-6 col-md">
            <h5>Contact</h5>
            <ul class="list-unstyled text-small">
              <li><a class="text-muted">Wechat: tt_666666666</a></li>
              <li><a class="text-muted" href="mailto:support@mail.nasdrop.info">Send Email</a></li>
            </ul>
          </div>
        </div>
      </footer>
    </section>

    <script>window.jQuery || document.write('<script src="../js/jquery-slim.min.js"><\/script>')</script>
    <script src="../js/popper.min.js"></script>
    <script src="../js/holder.min.js"></script>
    <script>
      Holder.addTheme('thumb', {
        bg: '#55595c',
        fg: '#eceeef',
        text: 'Thumbnail'
      });
      $("#contract").prop('href','https://explorer.nebulas.io/#/address/'+ dappAddress +'#/').prop('target', '_blank_');
    </script>

    <script>

      "use strict";
      //here we use neb.js to call the "get" function to search from the Dictionary
      var nebulas = require("nebulas");
      var Account = nebulas.Account;
      var neb = new nebulas.Neb();
      neb.setRequest(new nebulas.HttpRequest(rpcURL));

      // 搜索: 查找airdrops

      var from = Account.NewAccount().getAddressString();

      var len = 0;
      var value = "0";
      var nonce = "0";
      var gas_price = "1000000";
      var gas_limit = "2000000";
      var callFunction = "len";
      var callArgs = ""; //in the form of ["args"]
      var contract = {
        "function": callFunction,
        "args": callArgs
      };

      neb.api.call(from, dappAddress, value, nonce, gas_price, gas_limit, contract).then(function (resp) {
        if(resp.result > 0){
          len = resp.result;
          for(var i = 0; i < resp.result; i++){
            callFunction = "index";
            callArgs = "[" + i + "]"; //in the form of ["args"]
            contract = {
              "function": callFunction,
              "args": callArgs
            };
            neb.api.call(from, dappAddress, value, nonce, gas_price, gas_limit, contract).then(function (resp){
              addAirdrop(resp);
              });
          }
        } else {
          $("#airdrops").append('<h1>Oops! There are no airdrops! <a href="new.html">Create the first Airdrop</a></h1>');
        }
      }).catch(function (err) {
        //cbSearch(err)
        console.log("error:" + err.message)
      });


      function searchAdrress(address){
        if(Account.isValidAddress(address)){
          for(var i = 0; i < len; i++){
            callFunction = "query";
            callArgs = "[" + i + ", \"" + address +"\"]"; //in the form of ["args"]
            contract = {
              "function": callFunction,
              "args": callArgs
            };

            neb.api.call(from, dappAddress, value, nonce, gas_price, gas_limit, contract).then(function (resp) {
              var result = resp.result;
              if(result === 'null'){
                console.log("null");
              } else{
                try{
                  result = JSON.parse(result);
                }catch (err){
                  //result is the error message
                  console.log("error:" + err.message)
                }
                var airdrop;
                if(!!result.balance) {
                  airdrop = $("#airdrop" + result.index);
                  airdrop.html("Got " + result.balance + " Token").removeClass("btn-primary").addClass("btn-outline-primary").prop("onclick", null).off('click');
                } else {
                  airdrop = $("#airdrop" + result.index);
                  if(airdrop.val() == 0){
                    airdrop.html("Airdrop Over").removeClass("btn-primary").addClass("btn-outline-primary").prop("onclick", null).off('click');
                  } else {
                    airdrop.html("Get Airdrop").removeClass("btn-outline-primary").addClass("btn-primary").prop("onclick", null).off('click').click(function(){ receive(result.index); });
                  }
                }

              }
            }).catch(function (err) {
              //cbSearch(err)
              console.log("error:" + err.message)
            });
          }
        } else {
          if(address != ""){
            $(document).ready(function(){
              $("#invalidAddress").modal('show');
            });
          }
        }
      }

      function search(){
        var address = $("#address").val();
        if(address === ""){
          window.addEventListener('message', function (e) {
            if (e.data.data && !!e.data.data.account) {
              address = e.data.data.account;
              searchAdrress(address);
            }
          });

          window.postMessage({
            "target": "contentscript",
            "data": {},
            "method": "getAccount",
          }, "*");
        }
        searchAdrress(address);
      }

      function addAirdrop(resp){
        var result = resp.result;    ////resp is an object, resp.result is a JSON string
        if(result === 'null'){
          $("#airdrops").append('<h1>Oops! There are no airdrops! <a href="new.html">Create the first Airdrop</a></h1>');
        } else{
          //if result is not null, then it should be "return value" or "error message"
          try{
            result = JSON.parse(result);
          }catch (err){
            //result is the error message
          }


          var urlParams = new URLSearchParams(window.location.search);
          var referrer;
          if(urlParams.has('referrer')){
            referrer = urlParams.get('referrer');
          } else{
            referrer = "n1UUr6ipRiboc...";
          }

          if(!!result.name) {
            var skeleton;
            var data;
            if(result.active){
              if(urlParams.has('referrer')){
                skeleton = '<div class="card mb-4 box-shadow"><div class="card-header"><h5 class="my-0 font-weight-normal">{{name}}&nbsp;<a onclick="active({{airdropIndex}}, false)"><img src="../img/stop.png" height="20" width="20"></a><br><small>({{totalSupply}}&nbsp;{{symbol}} & {{holderNum}} Wallets)</small></h5></div><div class="card-body"><h1 class="card-title pricing-card-title"><a>{{holderBonus}}</a> {{symbol}} <small class="text-muted"> / Wallet</small></h1><small class="card-title">{{desc}}</small><br><small>Extra <a>{{referrerBonus}}</a>  {{symbol}} for you and your referrer by filling <b>referrer</b>\'s address </small><input type="text" class="form-control" id="referrer{{airdropIndex}}" placeholder="{{referrer}}" value="{{referrer}}"><br><input name="airdropIndex" type="hidden" value="{{airdropIndex}}"><button type="button" class="btn btn-lg btn-block btn-primary" id="airdrop{{airdropIndex}}" onclick="receive({{airdropIndex}})" value="{{active}}">Get Airdrop</button></div></div>';
              } else {
                skeleton = '<div class="card mb-4 box-shadow"><div class="card-header"><h5 class="my-0 font-weight-normal">{{name}}&nbsp;<a onclick="active({{airdropIndex}}, false)"><img src="../img/stop.png" height="20" width="20"></a><br><small>({{totalSupply}}&nbsp;{{symbol}} & {{holderNum}} Wallets)</small></h5></div><div class="card-body"><h1 class="card-title pricing-card-title"><a>{{holderBonus}}</a> {{symbol}} <small class="text-muted"> / Wallet</small></h1><small class="card-title">{{desc}}</small><br><small>Extra <a>{{referrerBonus}}</a>  {{symbol}} for you and your referrer by filling <b>referrer</b>\'s address</small><input type="text" class="form-control" id="referrer{{airdropIndex}}" placeholder="{{referrer}}" value=""><br><input name="airdropIndex" type="hidden" value="{{airdropIndex}}"><button type="button" class="btn btn-lg btn-block btn-primary" id="airdrop{{airdropIndex}}" onclick="receive({{airdropIndex}})" value="{{active}}">Get Airdrop</button></div></div>';
              }
              data = { name: result.name, symbol: result.symbol, totalSupply: result.totalSupply, holderNum: result.holderNum, holderBonus: result.holderBonus, referrerBonus: result.referrerBonus, desc: result.desc, airdropIndex: result.index, active: 1, referrer: referrer};
            } else {
              skeleton = '<div class="card mb-4 box-shadow"><div class="card-header"><h5 class="my-0 font-weight-normal">{{name}}&nbsp;<a onclick="active({{airdropIndex}}, true)"><img src="../img/start.png" height="20" width="20"></a><br><small>({{totalSupply}}&nbsp;{{symbol}} & {{holderNum}} Wallets)</small></h5></div><div class="card-body"><h1 class="card-title pricing-card-title"><a>{{holderBonus}}</a> {{symbol}} <small class="text-muted"> / Wallet</small></h1><small class="card-title">{{desc}}</small><br><small>Extra <a>{{referrerBonus}}</a>  {{symbol}} for you and your Referrer by filling <b>referrer</b>\'s address</small><input type="text" class="form-control" id="referrer{{airdropIndex}}" placeholder="{{referrer}}" value=""><br><input name="airdropIndex" type="hidden" value="{{airdropIndex}}"><button type="button" class="btn btn-lg btn-block btn-outline-primary" id="airdrop{{airdropIndex}}" value="{{active}}">Airdrop Over</button></div></div>';
              data = { name: result.name, symbol: result.symbol, totalSupply: result.totalSupply, holderNum: result.holderNum, holderBonus: result.holderBonus, referrerBonus: result.referrerBonus, desc: result.desc, airdropIndex: result.index, active: 0, referrer: referrer};
            }

            var html = Mustache.to_html(skeleton, data);
            if(promotion.includes(parseInt(result.index))){
              $("#promotions").append(html);
            } else if (airdrop.includes(parseInt(result.index))) {
              $("#airdrops").append(html);
            } else {
              $("#testAirdrops").append(html);
            }
            search();
          } else {
            $("#airdrops").append('<h1>Oops! There are no airdrops! <a href="new.html">Create the first Airdrop</a></h1>');
          }
        }
      }

      // 添加信息功能: 像super-dictionary 中添加词条
      var NebPay = require("nebpay");     //https://github.com/nebulasio/nebPay
      var nebPay = new NebPay();
      var serialNumber;

      function receive(index){
        if(checkNASWallet()){
          var to = dappAddress;
          var value = "0";
          var callFunction = "receive";
          var referrer = $("#referrer" + index).val();
          if(referrer == "" || Account.isValidAddress(referrer)){
            var callArgs = "[" + index + ", \"" + referrer + "\"]";
            console.log(callArgs);
            serialNumber = nebPay.call(to, value, callFunction, callArgs, {
              listener: function (resp) {
                if(resp !== 'Error: Transaction rejected by user'){
                  $('#packing').modal('show');
                }
                var hash = resp.txhash;
                recheckTransactionReceipt(hash, function () {
                  $('#packing').modal('hide');
                  $('#packing_success').modal('show');
                  function clearWait(){
                    clearInterval(wait);
                    window.location.href = window.location.href;
                  }
                  var wait = setInterval(clearWait, 2000);
                })
              }
            });
          } else {
            $(document).ready(function(){
              $("#invalidAddress").modal('show');
            });
          }
        }

      }

      function getTransactionReceipt(hash, callback){
        $.post(rpcURL + '/v1/user/getTransactionReceipt', JSON.stringify({
          "hash": hash
        }), function (resp) {
          callback(resp)
        })
      }


      function recheckTransactionReceipt(hash, cb) {
        var task = setInterval(function () {
          getTransactionReceipt(hash, function (resp) {
            var status = resp.result.status;
            if(status == 1){
              clearInterval(task);
              cb();
            }
          })
        }, 1000);
      }

      function active(index, _active){
        if(checkNASWallet()) {
          var to = dappAddress;
          var value = "0";
          var callFunction = "active";
          var callArgs;
          if (_active) {
            callArgs = "[" + index + ", " + 1 + "]";
          } else {
            callArgs = "[" + index + ", " + 0 + "]";
          }
          serialNumber = nebPay.call(to, value, callFunction, callArgs, {
            listener: function (resp) {
              if(resp !== 'Error: Transaction rejected by user'){
                $('#packing').modal('show');
              }
              var hash = resp.txhash;
              recheckTransactionReceipt(hash, function () {
                $('#packing').modal('hide');
                $('#packing_success').modal('show');
                function clearWait(){
                  clearInterval(wait);
                  window.location.href = window.location.href;
                }
                var wait = setInterval(clearWait, 2000);

              })
            }
          });

        }
      }

      function checkNASWallet(){

        //to check if the extension is installed
        //if the extension is installed, var "webExtensionWallet" will be injected in to web page
        if (typeof (webExtensionWallet) === "undefined") {
          $(document).ready(function(){
            $("#noWallet").modal('show');
          });
          return false;
        }
        return true;
      }


      function generateLink(){
        var url_refer = document.location.href;

        if(url_refer.lastIndexOf('?') >0){
          url_refer = url_refer.split("?")[0];
        }
        if(url_refer.lastIndexOf('#') > 0){
          url_refer = url_refer.split("#")[0];
          console.log(url_refer);
        }
        var address = $("#referrer_address").val();

        if (address === ""){
          window.addEventListener('message', function (e) {
            if (e.data.data && !!e.data.data.account) {
              address = e.data.data.account;
              if(Account.isValidAddress(address)){
                var skeleton = '<div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center"><a href="{{url_refer}}?referrer={{address}}"><p class="lead">{{url_refer}}?referrer={{address}}</p></a></div>';
                var data = { url_refer: url_refer, address: address};
                var html = Mustache.to_html(skeleton, data);
                $("#referrer_link").html('').append(html);
              }
            }
          });

          window.postMessage({
            "target": "contentscript",
            "data": {},
            "method": "getAccount",
          }, "*");
        } else {
          if(Account.isValidAddress(address)){
            var skeleton = '<div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center"><a href="{{url_refer}}?referrer={{address}}"><p class="lead">{{url_refer}}?referrer={{address}}</p></a></div>';
            var data = { url_refer: url_refer, address: address};
            var html = Mustache.to_html(skeleton, data);
            $("#referrer_link").html('').append(html);
          } else {
            $(document).ready(function(){
              $("#invalidAddress").modal('show');
            });
          }
        }
      }


    </script>

    <div id="noWallet" class="modal fade" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">Alert</h4>
          </div>
          <div class="modal-body">
            <p>Nebulas Wallet is not Installed. Please use Chrome and install it from <a href="https://github.com/ChengOrangeJu/WebExtensionWallet" target="_blank">https://github.com/ChengOrangeJu/WebExtensionWallet</a></p>
          </div>
          <div class="modal-footer"  style="padding-top: 10px">
            <br>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->


  <div id="invalidAddress" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Alert</h4>
        </div>
        <div class="modal-body">
          <p>Invalid Nebulas Address</p>
        </div>
        <div class="modal-footer"  style="padding-top: 10px">
          <br>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->

  <div id="packing" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Notice</h4>
        </div>
        <div class="modal-body">
          <p>The transaction is packing. Please wait several seconds.</p>
        </div>
        <div class="modal-footer"  style="padding-top: 10px">
          <br>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->

  <div id="packing_success" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Notice</h4>
        </div>
        <div class="modal-body">
          <p>The transaction is packed successful!</p>
        </div>
        <div class="modal-footer"  style="padding-top: 10px">
          <br>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->

  </body>
</html>
